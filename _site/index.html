<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <meta charset="utf-8">
  <title>Y≈´binkyoku üè£ - Tristan Hume</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <link rel="stylesheet" href="vendor/normalize.css">
  <link rel="stylesheet" href="vendor/skeleton.css">

  <!-- Favicon
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <!-- <link rel="icon" type="image/png" href="images/favicon.png"> -->
  <style type="text/css">
  .render-desc {
    max-width: 450px;
    min-height: 100px;
    flex-grow: 1;

    background-color: #f6f6f6;
    border-radius: 10px;
    padding: 10px;
    padding-right: 15px;
    margin-bottom: 10px;
    margin-right: 10px;

    display: flex;
    align-items: flex-start;
  }

  .render-desc p {
    margin-bottom: 0px;
  }

  .render-desc h5 {
    margin-bottom: 0px;
  }

  .render-thumb {
    max-height: 100px;
    max-width: 160px;
    border-radius: 10px;
  }

  .render-info {
    margin-left: 10px;
  }

  .render-active {
    background-color: #f0f0ff;
  }

  .section {
    margin-bottom: 100px;
  }

  .hide {
    display: none;
  }

  .render-descs {
    display: flex;
    flex-wrap: wrap;
  }

  .render-full-box {
    /*min-height: 800px;*/
  }
  </style>
</head>
<body>

  <!-- Primary Page Layout
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
  <div class="container u-max-full-width">
    <div class="row" style="margin-top: 50px;">
      <div class="seven columns">
        <h1>Y≈´binkyoku üè£</h1>
        <h5><a href="//thume.ca">Tristan Hume</a>'s photorealistic path tracer made for CS488</h5>
        <p>
          Made as my final project for UWaterloo's CS488 Graphics class, this is the demo page for my path tracing renderer made with the goal of maximum photorealism. It's named after the Japanese word for "post office" because it made so little sense as the name for a ray tracer that it made me burst out laughing, and there's an emoji for it.
        </p>
        <!-- <h2>Features</h2> -->
      </div>
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Prologue (Extra)</h3>
        <div>
          <p>First, for context for the rest of the renders, all my renders use an implementation of a subset of the Disney BRDF (Burley 2012). This is a high quality physically based microfacet BRDF including proper Fresnel and other effects for dielectrics and metals. My implementation has three parameters: albedo, metallness and roughness. I also implemented Phong Shading for my meshes.</p>

<p>I removed support for materials other than the Disney BRDF, hence why I‚Äôm showing it first. Similarly, Phong Shading is only disable-able by compile time switch, or by exporting a model without shared vertices.</p>

<p>After implementing the Disney BRDF, I rendered a simple scene with both Blender‚Äôs Cycles renderer and mine and they were a perfect match, which gave me confidence and allowed me to tune materials in Blender.</p>

          
          <p><strong>Extras shown:</strong> Disney BRDF, Phong shading</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-1 render-active"
            id="render-desc-1-1"
            data-file="fancy_mesh_73_nophong.png"
            data-sectionid="1"
            data-renderid="1">

            
            
            
            
<img src="renders/fancy_mesh_73_nophong.png" class="render-thumb" id="render-thumb-1-1"/>



            <div class="render-info">
              <h5>Disney BRDF</h5>
              <p>Suzanne monkey head model with dielectric 0.5 roughness Disney BRDF material.</p>

            </div>
          </div>
        
          <div class="render-desc desc-1 "
            id="render-desc-1-2"
            data-file="fancy_mesh_73_phong.png"
            data-sectionid="1"
            data-renderid="2">

            
            
            
            
<img src="renders/fancy_mesh_73_phong.png" class="render-thumb" id="render-thumb-1-2"/>



            <div class="render-info">
              <h5>Phong shading</h5>
              <p>Same scene rendered with Phong shading enabled.</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/fancy_mesh_73_nophong.png" class="
          u-max-full-width
          render-full-1
          
          " id="render-full-1-1"/>


        
          
          
          
          
<img src="renders/fancy_mesh_73_phong.png" class="
          u-max-full-width
          render-full-1
          hide
          " id="render-full-1-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Texture Mapping</h3>
        <div>
          <p>I implemented texture mapping by making my material take all of its attributes from a texture, and then implented the ability to create constant and image texture files from Lua. I added UV coordinates for meshes, cubes and spheres. Textures are filtered with bilinear filtering of the 4 nearest texels.</p>

<p>This allows mapping base colour, metalness and roughness. I also added special support for emission textures and rendering inside spheres to support environment maps.</p>

          
          <p><strong>Extras shown:</strong> Surface emission</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-2 render-active"
            id="render-desc-2-1"
            data-file="fancy_mesh_skybox.png"
            data-sectionid="2"
            data-renderid="1">

            
            
            
            
<img src="renders/fancy_mesh_skybox.png" class="render-thumb" id="render-thumb-2-1"/>



            <div class="render-info">
              <h5>Sky emission sphere</h5>
              <p>Sky texture mapped onto the inside of a giant sphere.</p>

            </div>
          </div>
        
          <div class="render-desc desc-2 "
            id="render-desc-2-2"
            data-file="fancy_mesh_paint.png"
            data-sectionid="2"
            data-renderid="2">

            
            
            
            
<img src="renders/fancy_mesh_paint.png" class="render-thumb" id="render-thumb-2-2"/>



            <div class="render-info">
              <h5>Painted mesh</h5>
              <p>Texture painted in Blender matches perfectly.</p>

            </div>
          </div>
        
          <div class="render-desc desc-2 "
            id="render-desc-2-3"
            data-file="fancy_mesh_cube.png"
            data-sectionid="2"
            data-renderid="3">

            
            
            
            
<img src="renders/fancy_mesh_cube.png" class="render-thumb" id="render-thumb-2-3"/>



            <div class="render-info">
              <h5>Varying material</h5>
              <p>Colour, metallness and roughness textures on a cube.</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/fancy_mesh_skybox.png" class="
          u-max-full-width
          render-full-2
          
          " id="render-full-2-1"/>


        
          
          
          
          
<img src="renders/fancy_mesh_paint.png" class="
          u-max-full-width
          render-full-2
          hide
          " id="render-full-2-2"/>


        
          
          
          
          
<img src="renders/fancy_mesh_cube.png" class="
          u-max-full-width
          render-full-2
          hide
          " id="render-full-2-3"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Normal Mapping</h3>
        <div>
          <p>I implemented normal mapping including the required tangents for meshes, cubes and spheres.</p>

<p>I verified with the test texture shown on the cube that the normals have the correct orientation.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-3 render-active"
            id="render-desc-3-1"
            data-file="fancy_mesh_cubenormal.png"
            data-sectionid="3"
            data-renderid="1">

            
            
            
            
<img src="renders/fancy_mesh_cubenormal.png" class="render-thumb" id="render-thumb-3-1"/>



            <div class="render-info">
              <h5>Test normal map</h5>
              <p>Shiny plastic cube with normal map</p>

            </div>
          </div>
        
          <div class="render-desc desc-3 "
            id="render-desc-3-2"
            data-file="studio_73_2.png"
            data-sectionid="3"
            data-renderid="2">

            
            
            
            
<img src="renders/studio_73_2.png" class="render-thumb" id="render-thumb-3-2"/>



            <div class="render-info">
              <h5>Fancy normal map</h5>
              <p>Textured and normal mapped surfaces</p>

            </div>
          </div>
        
          <div class="render-desc desc-3 "
            id="render-desc-3-3"
            data-file="studio_full_2.mp4"
            data-sectionid="3"
            data-renderid="3">

            
            
            
            
<video autoplay loop muted src="renders/studio_full_2.mp4" class="render-thumb" id="render-thumb-3-3">
    No video :-(
</video>



            <div class="render-info">
              <h5>Moving highlights</h5>
              <p>Animation showing highlights aren‚Äôt just textures</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/fancy_mesh_cubenormal.png" class="
          u-max-full-width
          render-full-3
          
          " id="render-full-3-1"/>


        
          
          
          
          
<img src="renders/studio_73_2.png" class="
          u-max-full-width
          render-full-3
          hide
          " id="render-full-3-2"/>


        
          
          
          
          
<video autoplay loop muted src="renders/studio_full_2.mp4" class="
          u-max-full-width
          render-full-3
          hide
          " id="render-full-3-3">
    No video :-(
</video>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Path Tracing</h3>
        <div>
          <p>I implemented global illumination using Path Tracing. I importance sample both the diffuse and specular lobes of the Disney BRDF.</p>

<p>My integrator is based on the path formulation of the rendering equation, where the integration is done in the outer loop so that path components can be re-used as they are extended and checked against direct lights at each bounce.</p>

<p>Mirror reflection was my A4 objective, but it‚Äôs now implemented an entirely different way as just a very low roughness material, where the importance sampling of the specular node leads to mirror-like results.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-4 render-active"
            id="render-desc-4-1"
            data-file="cornell_10313_plain.png"
            data-sectionid="4"
            data-renderid="1">

            
            
            
            
<img src="renders/cornell_10313_plain.png" class="render-thumb" id="render-thumb-4-1"/>



            <div class="render-info">
              <h5>Cornell box</h5>
              <p>Cornell box with diffuse objects showing colour bleed</p>

            </div>
          </div>
        
          <div class="render-desc desc-4 "
            id="render-desc-4-2"
            data-file="cornell_10313_refl.png"
            data-sectionid="4"
            data-renderid="2">

            
            
            
            
<img src="renders/cornell_10313_refl.png" class="render-thumb" id="render-thumb-4-2"/>



            <div class="render-info">
              <h5>Reflective sphere</h5>
              <p>With a sphere material emulating polished copper</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/cornell_10313_plain.png" class="
          u-max-full-width
          render-full-4
          
          " id="render-full-4-1"/>


        
          
          
          
          
<img src="renders/cornell_10313_refl.png" class="
          u-max-full-width
          render-full-4
          hide
          " id="render-full-4-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Soft Shadows</h3>
        <div>
          <p>I implemented soft shadows by overhauling my lighting model so that lights are just spheres with an emission texture on them, just like environment maps. I then changed the lights array normally passed into the render to just a list of <code class="highlighter-rouge">GeometryNode</code>s to sample explicitly.</p>

<p>The path tracing integrator then at each bounce samples the cone of directions subtended by the sphere that would fit in the bounding box of the objects. This means at the moment only spherical area lights work correctly. This is more efficient than sampling a point on the sphere since only visible positions on the light are sampled.</p>

<p>This also allows me to render the area light as a physical object that exists in the world, or I can put it in the list to be sampled but not the scene for an invisible light.</p>

          
          <p><strong>Extras shown:</strong> Lights in scene</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-5 render-active"
            id="render-desc-5-1"
            data-file="cornell_10313_area.png"
            data-sectionid="5"
            data-renderid="1">

            
            
            
            
<img src="renders/cornell_10313_area.png" class="render-thumb" id="render-thumb-5-1"/>



            <div class="render-info">
              <h5>Soft shadows</h5>
              <p>Cornell box with area light</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/cornell_10313_area.png" class="
          u-max-full-width
          render-full-5
          
          " id="render-full-5-1"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Glossy Reflection</h3>
        <div>
          <p>Glossy reflection falls out directly from the path tracing integrator and the specular lobe of the Disney BRDF, which uses an empirically based GGX distribution for the microfacet normals. I importance sample the GGX distribution term of the specular lobe so glossy reflection converges quickly.</p>

<p>With path tracing the only difference between specular highlights and glossy reflection is whether the light was directly sampled!</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-6 render-active"
            id="render-desc-6-1"
            data-file="cornell_12361_gloss_area.png"
            data-sectionid="6"
            data-renderid="1">

            
            
            
            
<img src="renders/cornell_12361_gloss_area.png" class="render-thumb" id="render-thumb-6-1"/>



            <div class="render-info">
              <h5>Glossy reflection</h5>
              <p>Cornell box with rough copper sphere</p>

            </div>
          </div>
        
          <div class="render-desc desc-6 "
            id="render-desc-6-2"
            data-file="cornell_10313_gloss_floor.png"
            data-sectionid="6"
            data-renderid="2">

            
            
            
            
<img src="renders/cornell_10313_gloss_floor.png" class="render-thumb" id="render-thumb-6-2"/>



            <div class="render-info">
              <h5>Glossy floor</h5>
              <p>Cornell box with shiny dielectric floor</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/cornell_12361_gloss_area.png" class="
          u-max-full-width
          render-full-6
          
          " id="render-full-6-1"/>


        
          
          
          
          
<img src="renders/cornell_10313_gloss_floor.png" class="
          u-max-full-width
          render-full-6
          hide
          " id="render-full-6-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Anti-aliasing</h3>
        <div>
          <p>Anti-aliasing is implemented as part of the same sampling framework that the path tracing uses. On each sample a random position in a square pixel region is picked to cast the ray for.</p>

<p>For textures I only do bilinear filtering with 4 texels so for high resolution textures anti-aliasing is also necessary for textured surfaces to look correct.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-7 render-active"
            id="render-desc-7-1"
            data-file="fancy_mesh_cube_noaa.png"
            data-sectionid="7"
            data-renderid="1">

            
            
            
            
<img src="renders/fancy_mesh_cube_noaa.png" class="render-thumb" id="render-thumb-7-1"/>



            <div class="render-info">
              <h5>Cube with no AA</h5>
              <p>Textured cube without anti-aliasing</p>

            </div>
          </div>
        
          <div class="render-desc desc-7 "
            id="render-desc-7-2"
            data-file="fancy_mesh_cube.png"
            data-sectionid="7"
            data-renderid="2">

            
            
            
            
<img src="renders/fancy_mesh_cube.png" class="render-thumb" id="render-thumb-7-2"/>



            <div class="render-info">
              <h5>Glossy floor</h5>
              <p>Textured cube with anti-aliasing</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/fancy_mesh_cube_noaa.png" class="
          u-max-full-width
          render-full-7
          
          " id="render-full-7-1"/>


        
          
          
          
          
<img src="renders/fancy_mesh_cube.png" class="
          u-max-full-width
          render-full-7
          hide
          " id="render-full-7-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Depth of Field</h3>
        <div>
          <p>I implement the thin lens model of depth of field by finding where the original ray intersects the focal plane, then sampling a random point on a disk representing the aperture of the camera and casting a ray from that point to the point on the focal plane.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-8 render-active"
            id="render-desc-8-1"
            data-file="dof_6217_fancy.png"
            data-sectionid="8"
            data-renderid="1">

            
            
            
            
<img src="renders/dof_6217_fancy.png" class="render-thumb" id="render-thumb-8-1"/>



            <div class="render-info">
              <h5>Cubes with DOF</h5>
              <p>Focal point is on the red cube</p>

            </div>
          </div>
        
          <div class="render-desc desc-8 "
            id="render-desc-8-2"
            data-file="dof_6217_nodof.png"
            data-sectionid="8"
            data-renderid="2">

            
            
            
            
<img src="renders/dof_6217_nodof.png" class="render-thumb" id="render-thumb-8-2"/>



            <div class="render-info">
              <h5>Cubes with no DOF</h5>
              <p>Comparison rendered with zero aprature</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/dof_6217_fancy.png" class="
          u-max-full-width
          render-full-8
          
          " id="render-full-8-1"/>


        
          
          
          
          
<img src="renders/dof_6217_nodof.png" class="
          u-max-full-width
          render-full-8
          hide
          " id="render-full-8-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Animation</h3>
        <div>
          <p>I implemented animation in Lua by constructing multiple scenes and rendering them to separate files, then using FFMPEG to stitch them together. The animation is done with math, logic and a cosine-based curve for smoothly easing in and out.</p>

<p>This scene shows a perfectly looping animation with rose gold and black plastic rounded hexagons on a metal surface.</p>

<p>This also shows off a bit of the distance field ray marching explained in the next section. In this case I use modulo to do a domain repetition of a rounded hexagonal bar primitive formula with the parameter being the rotation, which is driven from Lua.</p>

          
          <p><strong>Extras shown:</strong> Hex bar primitive, SDFs</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-9 render-active"
            id="render-desc-9-1"
            data-file="anim_hq.mp4"
            data-sectionid="9"
            data-renderid="1">

            
            
            
            
<video autoplay loop muted src="renders/anim_hq.mp4" class="render-thumb" id="render-thumb-9-1">
    No video :-(
</video>



            <div class="render-info">
              <h5>Abstract animation</h5>
              <p>Perfect loop!</p>

            </div>
          </div>
        
          <div class="render-desc desc-9 "
            id="render-desc-9-2"
            data-file="anim_hq_f-0t.png"
            data-sectionid="9"
            data-renderid="2">

            
            
            
            
<img src="renders/anim_hq_f-0t.png" class="render-thumb" id="render-thumb-9-2"/>



            <div class="render-info">
              <h5>First frame</h5>
              <p>Uncompressed render</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<video autoplay loop muted src="renders/anim_hq.mp4" class="
          u-max-full-width
          render-full-9
          
          " id="render-full-9-1">
    No video :-(
</video>


        
          
          
          
          
<img src="renders/anim_hq_f-0t.png" class="
          u-max-full-width
          render-full-9
          hide
          " id="render-full-9-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Constructive Solid Geometry</h3>
        <div>
          <p>I implemented Constructive Solid Geometry (CSG) in a different way than is standard for ray tracers. I implemented a primitive for ray marching a distance field. This is a method of rendering a 3D surface given a function from a point to the distance to a surface by taking steps along a ray based on the function.</p>

<p>Once that is implemented, CSG is simple to implement by taking the minimum (union) or maximum (intersection) of two distance functions, subtraction is taking the maximum with the negative of a signed distance function.</p>

          
          <p><strong>Extras shown:</strong> Ellipsoid primitive, SDFs</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-10 render-active"
            id="render-desc-10-1"
            data-file="csg_329_mat5.png"
            data-sectionid="10"
            data-renderid="1">

            
            
            
            
<img src="renders/csg_329_mat5.png" class="render-thumb" id="render-thumb-10-1"/>



            <div class="render-info">
              <h5>CSG Shape</h5>
              <p>Cube with spheres and ellipsoids subtracted and intersected</p>

            </div>
          </div>
        
          <div class="render-desc desc-10 "
            id="render-desc-10-2"
            data-file="csg_copper_hq.mp4"
            data-sectionid="10"
            data-renderid="2">

            
            
            
            
<video autoplay loop muted src="renders/csg_copper_hq.mp4" class="render-thumb" id="render-thumb-10-2">
    No video :-(
</video>



            <div class="render-info">
              <h5>CSG Animation</h5>
              <p>Showing parameterization and that it‚Äôs not a mesh</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/csg_329_mat5.png" class="
          u-max-full-width
          render-full-10
          
          " id="render-full-10-1"/>


        
          
          
          
          
<video autoplay loop muted src="renders/csg_copper_hq.mp4" class="
          u-max-full-width
          render-full-10
          hide
          " id="render-full-10-2">
    No video :-(
</video>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Mandelbox Primitive (Extra)</h3>
        <div>
          <p>Using distance field ray marching it is possible to render Mandelbrot-style iteration fractals by using the running derivative of the iteration as a distance estimate. I implemented the distance function for one such fractal, the Mandelbox.</p>

<p>I then used CSG to subtract and intersect with some cubes to carve out an interesting region inside the fractal, since the outside isn‚Äôt too impressive.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-11 render-active"
            id="render-desc-11-1"
            data-file="studio_585_smallmandel.png"
            data-sectionid="11"
            data-renderid="1">

            
            
            
            
<img src="renders/studio_585_smallmandel.png" class="render-thumb" id="render-thumb-11-1"/>



            <div class="render-info">
              <h5>Small Mandelbox</h5>
              <p>Wooden floor and small copper Mandelbox</p>

            </div>
          </div>
        
          <div class="render-desc desc-11 "
            id="render-desc-11-2"
            data-file="studio_585_bigredmandel.png"
            data-sectionid="11"
            data-renderid="2">

            
            
            
            
<img src="renders/studio_585_bigredmandel.png" class="render-thumb" id="render-thumb-11-2"/>



            <div class="render-info">
              <h5>Big red Mandelbox</h5>
              <p>Wooden floor and big red Mandelbox</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/studio_585_smallmandel.png" class="
          u-max-full-width
          render-full-11
          
          " id="render-full-11-1"/>


        
          
          
          
          
<img src="renders/studio_585_bigredmandel.png" class="
          u-max-full-width
          render-full-11
          hide
          " id="render-full-11-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>PORTALS! (Extra)</h3>
        <div>
          <p>In order to implement my final scene concept I needed portals, which for my case meant a way to have an object act as a portal where rays passing through it would end up in a different scene, bidirectionally.</p>

<p>I implemented this by giving all rays and surface hits a world number field. Then I modified my code so all scattering and light sampling would observe the world field and cast follow up and shadow rays with the same world.</p>

<p>Then I added a portal <code class="highlighter-rouge">SceneNode</code> subclass that checks the world ID of incoming rays and first tests it against that index of its children, as well as a special portal node pointer, and if it hits the portal before it hits the current world, it spawns a new ray in the next world number modulo its number of children, and does the required changing and remapping ray t values to spawn the new ray at the portal.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-12 render-active"
            id="render-desc-12-1"
            data-file="cornell_8265_portal.png"
            data-sectionid="12"
            data-renderid="1">

            
            
            
            
<img src="renders/cornell_8265_portal.png" class="render-thumb" id="render-thumb-12-1"/>



            <div class="render-info">
              <h5>Portal</h5>
              <p>Portal from Cornell box to wooden floor scene</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/cornell_8265_portal.png" class="
          u-max-full-width
          render-full-12
          
          " id="render-full-12-1"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="ten columns">
      
        <h3>Final Scene: "Realism"</h3>
        <div>
          <p>My goal was to render a scene that was as photorealistic as possible while having elements that clearly couldn‚Äôt be real. shows off high quality textures and models (not done by me) in a scene I arranged and tuned the materials for. Uses a portal, a Mandelbox, global illumination, and various hand-tuned Disney BRDF materials.</p>

          
          <p><strong>Extras shown:</strong> Non-filtered textures</p>
          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-13 render-active"
            id="render-desc-13-1"
            data-file="final_1097_mc6_4k_dof.png"
            data-sectionid="13"
            data-renderid="1">

            
            
            
            
<img src="renders/final_1097_mc6_4k_dof.png" class="render-thumb" id="render-thumb-13-1"/>



            <div class="render-info">
              <h5>"Realism"</h5>
              <p>Final scene</p>

            </div>
          </div>
        
          <div class="render-desc desc-13 "
            id="render-desc-13-2"
            data-file="final_1097_mc6_4k.png"
            data-sectionid="13"
            data-renderid="2">

            
            
            
            
<img src="renders/final_1097_mc6_4k.png" class="render-thumb" id="render-thumb-13-2"/>



            <div class="render-info">
              <h5>Zero Aperture</h5>
              <p>No depth of field to show details</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div>
      
        
          
          
          
          
<img src="renders/final_1097_mc6_4k_dof.png" class="
          u-max-full-width
          render-full-13
          
          " id="render-full-13-1"/>


        
          
          
          
          
<img src="renders/final_1097_mc6_4k.png" class="
          u-max-full-width
          render-full-13
          hide
          " id="render-full-13-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="ten columns">
      
        <h3>Filmic Tone Mapping (Extra)</h3>
        <div>
          <p>An important part of the photorealism of my renders is very high quality tone mapping. I implemented a parser for the 1D and 3D OpenColorIO lookup table (LUT) formats, and a function to apply them correctly with linear and trilinear interpolation respectively.</p>

<p>The good tone mapping allows for scenes with realistic high dynamic range lighting to render properly without getting blown out and with photo-like colour. As you can see from the render with no tone mapping where the colours are bad, the sun on the keyboard is totally blown out, and the shades of black on the display rim are lost.</p>

<p>I can also use different LUTs for different scenes. I rendered my final scene with a more camera-like LUT with lots of dynamic range, but the rest of my scenes with a higher contrast LUT that gives punchier colours but isn‚Äôt as photorealistic.</p>

<p>I can also use a false colour LUT to see what the dynamic range of my scene is like.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-14 render-active"
            id="render-desc-14-1"
            data-file="final_585_notone.png"
            data-sectionid="14"
            data-renderid="1">

            
            
            
            
<img src="renders/final_585_notone.png" class="render-thumb" id="render-thumb-14-1"/>



            <div class="render-info">
              <h5>No mapping</h5>
              <p>Final scene with no tone mapping</p>

            </div>
          </div>
        
          <div class="render-desc desc-14 "
            id="render-desc-14-2"
            data-file="final_585_false.png"
            data-sectionid="14"
            data-renderid="2">

            
            
            
            
<img src="renders/final_585_false.png" class="render-thumb" id="render-thumb-14-2"/>



            <div class="render-info">
              <h5>False Colour</h5>
              <p>Showing dynamic range</p>

            </div>
          </div>
        
          <div class="render-desc desc-14 "
            id="render-desc-14-3"
            data-file="final_1097_mc6_4k.png"
            data-sectionid="14"
            data-renderid="3">

            
            
            
            
<img src="renders/final_1097_mc6_4k.png" class="render-thumb" id="render-thumb-14-3"/>



            <div class="render-info">
              <h5>Normal Comparison</h5>
              <p>The LUT used for the main render</p>

            </div>
          </div>
        
          <div class="render-desc desc-14 "
            id="render-desc-14-4"
            data-file="final_585_highcontrast.png"
            data-sectionid="14"
            data-renderid="4">

            
            
            
            
<img src="renders/final_585_highcontrast.png" class="render-thumb" id="render-thumb-14-4"/>



            <div class="render-info">
              <h5>Higher contrast LUT</h5>
              <p>Final scene rendered with high-contrast LUT used for other renders</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div>
      
        
          
          
          
          
<img src="renders/final_585_notone.png" class="
          u-max-full-width
          render-full-14
          
          " id="render-full-14-1"/>


        
          
          
          
          
<img src="renders/final_585_false.png" class="
          u-max-full-width
          render-full-14
          hide
          " id="render-full-14-2"/>


        
          
          
          
          
<img src="renders/final_1097_mc6_4k.png" class="
          u-max-full-width
          render-full-14
          hide
          " id="render-full-14-3"/>


        
          
          
          
          
<img src="renders/final_585_highcontrast.png" class="
          u-max-full-width
          render-full-14
          hide
          " id="render-full-14-4"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Tone Desaturation (Extra)</h3>
        <div>
          <p>Part of the tone mapping is a 3D LUT that desaturates very bright colours, simulating bleed between film layers, which can produce a pleasing effect with very bright colours getting desaturated. This effectively allows for more dynamic range to be shown.</p>

<p>This scene shows includes a ridiculously bright pure pink light to demonstrate.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-15 render-active"
            id="render-desc-15-1"
            data-file="outside_73_notone.png"
            data-sectionid="15"
            data-renderid="1">

            
            
            
            
<img src="renders/outside_73_notone.png" class="render-thumb" id="render-thumb-15-1"/>



            <div class="render-info">
              <h5>No mapping</h5>
              <p>Blowout of a colour light</p>

            </div>
          </div>
        
          <div class="render-desc desc-15 "
            id="render-desc-15-2"
            data-file="outside_73_nodesat.png"
            data-sectionid="15"
            data-renderid="2">

            
            
            
            
<img src="renders/outside_73_nodesat.png" class="render-thumb" id="render-thumb-15-2"/>



            <div class="render-info">
              <h5>1D LUT</h5>
              <p>Tone mapping with just a 1D LUT</p>

            </div>
          </div>
        
          <div class="render-desc desc-15 "
            id="render-desc-15-3"
            data-file="outside_73_tone.png"
            data-sectionid="15"
            data-renderid="3">

            
            
            
            
<img src="renders/outside_73_tone.png" class="render-thumb" id="render-thumb-15-3"/>



            <div class="render-info">
              <h5>3D Desaturation LUT</h5>
              <p>With desaturation LUT</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/outside_73_notone.png" class="
          u-max-full-width
          render-full-15
          
          " id="render-full-15-1"/>


        
          
          
          
          
<img src="renders/outside_73_nodesat.png" class="
          u-max-full-width
          render-full-15
          hide
          " id="render-full-15-2"/>


        
          
          
          
          
<img src="renders/outside_73_tone.png" class="
          u-max-full-width
          render-full-15
          hide
          " id="render-full-15-3"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Low Discrepancy Sampling (Extra)</h3>
        <div>
          <p>I implemented sampling using the Sobol (0,2) sequence using a fast gray code technique from the <a href="http://www.pbrt.org/">PBRT book</a>. These samples have better distribution in many dimensions and can be used progressively, leading to faster render convergence rates.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-16 render-active"
            id="render-desc-16-1"
            data-file="dof_9_plain_uniform.png"
            data-sectionid="16"
            data-renderid="1">

            
            
            
            
<img src="renders/dof_9_plain_uniform.png" class="render-thumb" id="render-thumb-16-1"/>



            <div class="render-info">
              <h5>Uniform random</h5>
              <p>9 samples of DOF with uniform random sampling</p>

            </div>
          </div>
        
          <div class="render-desc desc-16 "
            id="render-desc-16-2"
            data-file="dof_9_plain_02.png"
            data-sectionid="16"
            data-renderid="2">

            
            
            
            
<img src="renders/dof_9_plain_02.png" class="render-thumb" id="render-thumb-16-2"/>



            <div class="render-info">
              <h5>Low-discrepancy</h5>
              <p>9 samples of DOF with (0,2) sequence sampling</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/dof_9_plain_uniform.png" class="
          u-max-full-width
          render-full-16
          
          " id="render-full-16-1"/>


        
          
          
          
          
<img src="renders/dof_9_plain_02.png" class="
          u-max-full-width
          render-full-16
          hide
          " id="render-full-16-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="ten columns">
      
        <h3>Blender Export (Extra)</h3>
        <div>
          <p>I put my final scene together in Blender and it took over 15 hours to do, if I had to do it entirely with conversion scripts and lua files it would have been infeasible. So I wrote a script using Blender‚Äôs Python API that exports all objects in the scene into OBJ files and a lua file that references them all and sets them up with the right materials.</p>

<p>I can then reference the objects defined in this lua file in my final scene‚Äôs lua file, while adding arrangements like portals that Blender can‚Äôt do. It also exports object transforms separately so I can do things like replace a cube with a Mandelbox.</p>

<p>I used the same set of film emulation LUTs included in Blender so that I could match Cycles almost exactly.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-17 render-active"
            id="render-desc-17-1"
            data-file="blender_1.png"
            data-sectionid="17"
            data-renderid="1">

            
            
            
            
<img src="renders/blender_1.png" class="render-thumb" id="render-thumb-17-1"/>



            <div class="render-info">
              <h5>Blender</h5>
              <p>Final scene in Blender</p>

            </div>
          </div>
        
          <div class="render-desc desc-17 "
            id="render-desc-17-2"
            data-file="blender_2.png"
            data-sectionid="17"
            data-renderid="2">

            
            
            
            
<img src="renders/blender_2.png" class="render-thumb" id="render-thumb-17-2"/>



            <div class="render-info">
              <h5>Previewing</h5>
              <p>Using Cycles to preview parts of the scene</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div>
      
        
          
          
          
          
<img src="renders/blender_1.png" class="
          u-max-full-width
          render-full-17
          
          " id="render-full-17-1"/>


        
          
          
          
          
<img src="renders/blender_2.png" class="
          u-max-full-width
          render-full-17
          hide
          " id="render-full-17-2"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Progressive Rendering (Extra)</h3>
        <div>
          <p>I made my renderer progressive by saving a matrix of Sobol sampler states and running my sampler in epochs of gradually increasing sample count, while keeping the samples for each pixel in each epoch in the innermost loop for cache/branch prediction efficiency. Every epoch it saves an image of its progress so far.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-18 render-active"
            id="render-desc-18-1"
            data-file="cornell_1.png"
            data-sectionid="18"
            data-renderid="1">

            
            
            
            
<img src="renders/cornell_1.png" class="render-thumb" id="render-thumb-18-1"/>



            <div class="render-info">
              <h5>1 sample</h5>
              <p>9 samples image of a Cornell box</p>

            </div>
          </div>
        
          <div class="render-desc desc-18 "
            id="render-desc-18-2"
            data-file="cornell_9.png"
            data-sectionid="18"
            data-renderid="2">

            
            
            
            
<img src="renders/cornell_9.png" class="render-thumb" id="render-thumb-18-2"/>



            <div class="render-info">
              <h5>9 samples</h5>
              <p>9 samples image from same run</p>

            </div>
          </div>
        
          <div class="render-desc desc-18 "
            id="render-desc-18-3"
            data-file="cornell_73.png"
            data-sectionid="18"
            data-renderid="3">

            
            
            
            
<img src="renders/cornell_73.png" class="render-thumb" id="render-thumb-18-3"/>



            <div class="render-info">
              <h5>73 samples</h5>
              <p>73 samples image from same run</p>

            </div>
          </div>
        
          <div class="render-desc desc-18 "
            id="render-desc-18-4"
            data-file="cornell_10313_area.png"
            data-sectionid="18"
            data-renderid="4">

            
            
            
            
<img src="renders/cornell_10313_area.png" class="render-thumb" id="render-thumb-18-4"/>



            <div class="render-info">
              <h5>10313 samples</h5>
              <p>10313 samples image from same run</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/cornell_1.png" class="
          u-max-full-width
          render-full-18
          
          " id="render-full-18-1"/>


        
          
          
          
          
<img src="renders/cornell_9.png" class="
          u-max-full-width
          render-full-18
          hide
          " id="render-full-18-2"/>


        
          
          
          
          
<img src="renders/cornell_73.png" class="
          u-max-full-width
          render-full-18
          hide
          " id="render-full-18-3"/>


        
          
          
          
          
<img src="renders/cornell_10313_area.png" class="
          u-max-full-width
          render-full-18
          hide
          " id="render-full-18-4"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="four columns">
      
        <h3>Multithreading & Bar (Extra)</h3>
        <div>
          <p>I made my renderer multithreaded using all available hyperthreads using the C++11 threading library. It distributes rows of image alternately to each thread for evenly distributed difficulty. I implemented a multi-threaded progress bar with proper locking to print nice console progress with ANSI escape codes.</p>

<p>It scales linearly with number of cores. I rendered most images on this page on a 64 core pre-emptible Google Cloud instance for only $0.50 an hour.</p>

          
        </div>
        
        <div class="render-descs">
        
          <div class="render-desc desc-19 render-active"
            id="render-desc-19-1"
            data-file="progress_crop.png"
            data-sectionid="19"
            data-renderid="1">

            
            
            
            
<img src="renders/progress_crop.png" class="render-thumb" id="render-thumb-19-1"/>



            <div class="render-info">
              <h5>Progress bar</h5>
              <p>Console output of a render</p>

            </div>
          </div>
        
        </div>
        
      </div>
      
      
      <div class="eight columns render-full-box">
      
        
          
          
          
          
<img src="renders/progress_crop.png" class="
          u-max-full-width
          render-full-19
          
          " id="render-full-19-1"/>


        
      </div>
      
    </div>
    
    
    <div class="row section">
      
      <div class="seven columns">
      
        <h3>Misc. Acceleration (Extra)</h3>
        <div>
          <p>I implemented a number of optimizations so that I could render large scenes with path tracing in a reasonable amount of time. I don‚Äôt have graphs because these are mostly asymptotic or varying by scene so I could make the graphs show whatever I wanted.</p>

<ul>
  <li>So that I could render large meshes, I integrated the <a href="https://github.com/brandonpelfrey/Fast-BVH">FastBVH</a> bounding box hierarchy library into my mesh primitive. This took about 2 hours.</li>
  <li>I implemented my own bounding box hierachy checks at the scene node level, although that hierarchy is just the manually constructed hierarchy from Lua.</li>
  <li>I baked the hierarchical transform down into each <code class="highlighter-rouge">GeometryNode</code> and only apply the transform if it is not the identity, to reduce the number of matrix multiplies per ray per object.</li>
  <li>When implementing formulas, I follow best practices for floating point performance and avoid or precompute square roots, trig functions and divisions wherever possible using a number of standard tricks.</li>
  <li>I use the Moller-Trumbore ray-triangle intersection method which is just an algebraic improvement on the one presented in class, but is much faster.</li>
</ul>

          
        </div>
        
      </div>
      
    </div>
    
  </div>

<!-- End Document
  ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì -->
<script type="text/javascript">
var renders = document.querySelectorAll(".render-desc");

function selectRender(renderDesc) {
  // console.log(renderDesc.dataset);

  // Deselect all
  var sectionRenders = document.querySelectorAll(".desc-"+renderDesc.dataset.sectionid);
  sectionRenders.forEach(function(other) {
    other.classList.remove('render-active');
  });
  renderDesc.classList.add('render-active');

  // Deselect all
  var sectionRenders = document.querySelectorAll(".render-full-"+renderDesc.dataset.sectionid);
  sectionRenders.forEach(function(other) {
    other.classList.add('hide');
  });
  var selectedFullRender = document.getElementById("render-full-"+renderDesc.dataset.sectionid + "-" + renderDesc.dataset.renderid);
  selectedFullRender.classList.remove('hide');

  // var fullRenderImg = document.getElementById("render-full-"+renderDesc.dataset.sectionid);
  // fullRenderImg.src = "renders/" + renderDesc.dataset.file;
}

renders.forEach(function(renderDesc) {
  renderDesc.addEventListener("mouseenter", function( event ) {
    selectRender(renderDesc);
  });
  renderDesc.addEventListener("touchstart", function( event ) {
    selectRender(renderDesc);
  });
});
</script>
</body>
</html>
